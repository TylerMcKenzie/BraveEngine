<html>
<head>
	<meta charset="UTF-8">
	<title>BraveEngine.js Test</title>
</head>
<body>
	TEST
</body>
<script type="text/javascript">
	!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var s=class{constructor(t=0,e=0){this._x=t,this._y=e}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}add({x:t=0,y:e=0},i=1){this._x+=t*i,this._y+=e*i}},r=class{constructor({x:t=0,y:e=0}){this.position=new s(t,e)}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t}set y(t){this.position.y=t}_draw(t,e){}_render(t=this.x,e=this.y,i=0,s=0){this._draw(t-i,e-s)}},h=class extends r{constructor({text:t="",x:e=0,y:i=0,context:s=null,font:r}){super({x:e,y:i}),this.text=t,this.context=s;let h=Object.assign({},{fontFamily:"sans-serif",fontSize:10,textAlign:"start",direction:"inherit",textBaseline:"alphabetic",fill:"fill",color:"black"},r);this.font=h}get width(){const{fontSize:t,fontFamily:e}=this.font;let i;return this.context.save(),this.context.font=`${t}px ${e}`,i=this.context.measureText(this.text).width,this.context.restore(),i}update(){}_draw(t,e){let{fontSize:i,fontFamily:s,textAlign:r,textBaseline:h,direction:o,fill:a,color:n}=this.font;this.context.save(),this.context.font=`${i}px ${s}`,this.context.textAlign=r,this.context.textBaseline=h,this.context.direction=o,"fill"===a?(this.context.fillStyle=n,this.context.fillText(this.text,t,e)):"stroke"===a&&(this.context.strokeStyle=n,this.context.strokeText(this.text,t,e)),this._width=this.context.measureText(this.text).width,this.context.restore()}},o=class{constructor({x:t=0,y:e=0,rotation:i=0}){this.position=new s(t,e),this.rotation=i}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t}set y(t){this.position.y=t}rotate(t){this.rotation+=t;let e=t*Math.PI/180,i=Math.cos(e),s=Math.sin(e);this.x=this.x*i-this.y*s,this.y=this.y*s-this.x*i}};class a extends o{static generateVectorPoints(t){return t.map(t=>new s(t.x,t.y))}constructor({x:t,y:e,rotation:i,points:s=[]}){super({x:t,y:e,rotation:i}),this._points=a.generateVectorPoints(s)}get points(){return this._points.map(t=>{let{x:e,y:i}=t;return{x:e+=this.x,y:i+=this.y}})}hasPoint({x:t,y:e}){let i=!1;for(let s=0,r=this._points.length-1;s<this._points.length;s++){let{x:h,y:o}=this._points[s],{x:a,y:n}=this._points[r],c=h+this.x,d=o+this.y,l=a+this.x,u=n+this.y;d>e!=u>e&&t<(l-c)*(e-d)/(u-d)+c&&(i=!i),r=s}return i}scale(t){this._points=this._points.map(e=>(e.x*=t,e.y*=t,e))}rotate(t){let e=t*Math.PI/180,i=Math.cos(e),s=Math.sin(e);this._points=this._points.map(t=>{let{x:e,y:r}=t;return t.x=e*i-r*s,t.y=e*s+r*i,t}),this.rotation+=t}}var n=a,c=class extends o{constructor({x:t,y:e,rotation:i,radius:s=0}){super({x:t,y:e,rotation:i}),this._radius=s}get radius(){return this._radius}set radius(t){this._radius=t}hasPoint({x:t,y:e}){let i=t-this.x,s=e-this.y;return Math.sqrt(i*i+s*s)<this._radius}scale(t){this._radius*=t}};class d extends n{static generateRectanglePoints(t,e){let i=[];return i.push({x:0,y:0}),i.push({x:t,y:0}),i.push({x:t,y:e}),i.push({x:0,y:e}),i}constructor({x:t,y:e,width:i=0,height:s=0,rotation:r}){super({x:t,y:e,points:d.generateRectanglePoints(i,s),rotation:r}),this._width=i,this._height=s}get width(){return this._width}get height(){return this._height}set width(t){this._width=t;let e=d.generateRectanglePoints(t,this._height),i=d.generateVectorPoints(e);this._points=i}set height(t){this._height=t;let e=d.generateRectanglePoints(this._width,t),i=d.generateVectorPoints(e);this._points=i}}var l=d;class u extends n{static generateSquareCoordinates(t){let e=[];return e.push({x:0,y:0}),e.push({x:t,y:0}),e.push({x:t,y:t}),e.push({x:0,y:t}),e}constructor({x:t,y:e,rotation:i,size:s=0}){super({x:t,y:e,points:u.generateSquareCoordinates(s),rotation:i}),this._size=s}get size(){return this._size}set size(t){this._size=t;let e=u.generateSquareCoordinates(t),i=u.generateVectorPoints(e);this._points=i}}var p=u;class x{static shapeType(t){return t instanceof n?"Polygon":t instanceof c?"Circle":t instanceof p?"Square":t instanceof l?"Rectangle":void 0}static shape({type:t,x:e,y:i,rotation:s,width:r,height:h,size:o,points:a,radius:n}){let c;switch(t){case"square":c=x.square({x:e,y:i,rotation:s,size:o});break;case"rectangle":c=x.rectangle({x:e,y:i,rotation:s,width:r,height:h});break;case"circle":c=x.circle({x:e,y:i,rotation:s,radius:n});break;case"polygon":c=x.polygon({x:e,y:i,rotation:s,points:a});break;default:throw new Error(`Type must be one of the following: 'square', 'rectangle', 'circle', or 'polygon'. Got "${t}"`)}return c}static rectangle({x:t,y:e,rotation:i,width:s,height:r}){return new l({x:t,y:e,rotation:i,width:s,height:r})}static square({x:t,y:e,rotation:i,size:s}){return new p({x:t,y:e,rotation:i,size:s})}static circle({x:t,y:e,rotation:i,radius:s}){return new c({x:t,y:e,rotation:i,radius:s})}static polygon({x:t,y:e,rotation:i,points:s}){return new n({x:t,y:e,rotation:i,points:s})}}var w=x,g=class{static polygonWithPolygon(t,e){for(let i of e.points)if(t.hasPoint(i))return!0;for(let i of t.points)if(e.hasPoint(i))return!0;return!1}static circleWithPolygon(t,e){for(let i=0,s=e.points.length-1;i<e.points.length;i++){if(t.hasPoint(e.points[i]))return!0;{let{x:r,y:h}=e.points[i],{x:o,y:a}=e.points[s],n=o-r,c=a-h,d=180*Math.atan2(c,n)/Math.PI,l=t.x+t.radius*Math.cos(d*Math.PI/180),u=t.y+t.radius*Math.sin(d*Math.PI/180);if(e.hasPoint({x:l,y:u}))return!0;s=i}}return!1}static circleWithCircle(t,e){let i=e.x-t.x,s=e.y-t.y;return Math.sqrt(i*i+s*s)<t.radius+e.radius}};class y{constructor(t){this.shape=w.shape(t)}get x(){return this.shape.x}get y(){return this.shape.y}set x(t){this.shape.x=t}set y(t){this.shape.y=t}testCollision(t){if(!t instanceof y)throw new Error(`Expected Hitbox object, got ${t}.`);let e=w.shapeType(this.shape),i=w.shapeType(t.shape);return"Circle"!==e&&"Circle"!==i?g.polygonWithPolygon(this.shape,t.shape):"Circle"===e&&"Circle"===i?g.circleWithCircle(this.shape,t.shape):"Circle"!==e&&"Circle"===i?g.circleWithPolygon(t.shape,this.shape):"Circle"===e&&"Circle"!==i?g.circleWithPolygon(this.shape,t.shape):void 0}}var f=y,m=class{constructor({spritesheet:t,frames:e,frameRate:i}){this.spritesheet=t,this.frames=e,this.frameRate=i;let{frame:s}=this.spritesheet;this.width=s.width,this.height=s.height,this.margin=s.margin||0,this._currentFrame=0,this._accumulator=0}reset(){this._currentFrame=0,this._accumulator=0}update(t=1/60){for(t=t,this._accumulator+=t;this._accumulator*this.frameRate>=1;)this._currentFrame=++this._currentFrame%this.frames.length,this._accumulator-=1/this.frameRate}_draw(t,e,i){let s=this.frames[this._currentFrame]/this.spritesheet.framesPerRow|0,r=this.frames[this._currentFrame]%this.spritesheet.framesPerRow|0;t.drawImage(this.spritesheet.image,r*this.width+(2*r+1)*this.margin,s*this.height+(2*s+1)*this.margin,this.width,this.height,e,i,this.width,this.height)}},_=class{constructor({animations:t={},image:e,frameWidth:i,frameHeight:s,frameMargin:r=0}){if(!e)throw new Error(`An image must be provided for the SpriteSheet, got ${e}`);this.image=e,this.animations=t,this.frame={width:i,height:s,margin:r},this.framesPerRow=this.image.width/this.frame.width||0,this.currentAnimation=null,this.generateAnimations(this.animations)}playAnimation(t){this.currentAnimation.reset(),this.currentAnimation=this.animations[t]}generateAnimations(t){for(let e in t){let{frames:i,frameRate:s}=t[e];this.animations[e]=new m({spritesheet:this,frames:i,frameRate:s}),this.currentAnimation||(this.currentAnimation=this.animations[e])}}},v=class extends r{constructor({width:t=0,height:e=0,color:i="black",x:r=0,y:h=0,z:o,velX:a=0,velY:n=0,accX:c=0,accY:d=0,ttl:l=0,update:u,advance:p,render:x,draw:w,context:g=null,image:y=null,spritesheet:m,origin:v="top-left",hitbox:b}){super({x:r,y:h}),this.z=o,this.velocity=new s(a,n),this.acceleration=new s(c,d),this.ttl=l,this.context=g,this.width=t,this.height=e,b?(this.hitbox=new f(b),this.hitbox.x=this.x,this.hitbox.y=this.y):this.hitbox=new f({type:"rectangle",x:this.x,y:this.y,rotation:0,width:this.width,height:this.height}),this.color=i,this.advance=p||this._advance,this.update=function(t){this._update(t),this.hitbox.x=this.x,this.hitbox.y=this.y},this.render=x||this._render,this._draw=w||this._draw,y?(this._image=y,this._draw=this._drawImg):m&&(this.spritesheet=new _(m),this._draw=this._drawAnimation,this.advance=this._advanceAnimation),this._originLocation=v}get velX(){return this.velocity.x}get velY(){return this.velocity.y}get accX(){return this.acceleration.x}get accY(){return this.acceleration.y}get origin(){let{x:t,y:e}=this.position,i=this.width,s=this.height;switch(this._originLocation){case"top-left":return{x:t,y:e};case"top-right":return{x:t+i,y:e};case"bottom-right":return{x:t+i,y:e+s};case"bottom-left":return{x:t,y:e+s};case"top-center":return{x:t+i/2,y:e};case"right-center":return{x:t+i,y:e+s/2};case"bottom-center":return{x:t+i/2,y:e+s};case"left-center":return{x:t,y:e+s/2};case"center":return{x:t+i/2,y:e+s/2}}}set velX(t){this.velocity.x=t}set velY(t){this.velocity.y=t}set accX(t){this.acceleration.x=t}set accY(t){this.acceleration.y=t}_update(t){this.advance(t)}_draw(t,e){this.context.save(),this.context.fillStyle=this.color,this.context.fillRect(t,e,this.width,this.height),this.context.restore()}_drawImg(t,e){this.context.save(),this.context.drawImage(this._image,t,e),this.context.restore()}_drawAnimation(t,e){this.context.save(),this.spritesheet.currentAnimation._draw(this.context,t,e),this.context.restore()}_advance(t){this.velocity.add(this.acceleration,t),this.position.add(this.velocity,t),this.ttl--}_advanceAnimation(t){this._advance(t),this.spritesheet.currentAnimation.update(t)}isAlive(){return this.ttl>0}collidesWith(t){return this.hitbox.testCollision(t.hitbox)}},b=class extends r{constructor({x:t=0,y:e=0,color:i="black",shape:s,context:r=null,update:h=(t=>{})}){super({x:t,y:e}),this.color=i,s.x=this.x,s.y=this.y,this.shape=w.shape(s),this._shapeType=s.type,this.update=(t=>{h(t),this._update(t)}),this.context=r}_update(){this.shape.x=this.x,this.shape.y=this.y}_draw(t,e){this.context.save(),this.context.beginPath(),this.context.fillStyle=this.color,"circle"===this._shapeType?this.context.arc(t,e,this.shape.radius,0,2*Math.PI,!1):this.shape.points.map(t=>{this.context.lineTo(t.x,t.y)}),this.context.closePath(),this.context.fill(),this.context.restore()}};class P{static get AXIS(){return{NONE:"none",HORIZONTAL:"horizontal",VERTICAL:"vertical",BOTH:"both"}}constructor({xView:t=0,yView:e=0,width:i,height:s,worldWidth:r,worldHeight:h}){this.xView=t,this.yView=e,this.viewportWidth=i,this.viewportHeight=s,this.deadZoneX=i/2,this.deadZoneY=s/2,this._axis=P.AXIS.BOTH,this.followed=null,this.viewport=new l({x:this.xView,y:this.yView,width:this.viewportWidth,height:this.viewportHeight}),r&&h&&(this.worldWidth=r,this.worldHeight=h,this.worldBounds=new l({x:0,y:0,width:this.worldWidth,height:this.worldHeight}))}get axis(){return this._axis}set axis(t){switch(t){case P.AXIS.HORIZONTAL:this._axis=P.AXIS.HORIZONTAL;break;case P.AXIS.VERTICAL:this._axis=P.AXIS.VERTICAL;break;case P.AXIS.BOTH:this._axis=P.AXIS.BOTH;break;case P.AXIS.NONE:this._axis=P.AXIS.NONE;break;default:throw new Error("Invalid setting of axis. Accepted values are: 'horizontal', 'vertical', 'both', and 'none'.")}}follow(t,e=0,i=0){this.followed=t,this.deadZoneX=this.viewportWidth/2-e,this.deadZoneY=this.viewportHeight/2-i,this.update()}unfollow(){this.followed=null}update(){null!=this.followed&&(this.axis!==P.AXIS.HORIZONTAL&&this.axis!==P.AXIS.BOTH||(this.followed.x-this.xView+this.deadZoneX>this.viewportWidth?this.xView=this.followed.x-(this.viewportWidth-this.deadZoneX):this.followed.x-this.deadZoneX<this.xView&&(this.xView=this.followed.x-this.deadZoneX)),this.axis!==P.AXIS.VERTICAL&&this.axis!==P.AXIS.BOTH||(this.followed.y-this.yView+this.deadZoneY>this.viewportHeight?this.yView=this.followed.y-(this.viewportHeight-this.deadZoneY):this.followed.y-this.deadZoneY<this.yView&&(this.yView=this.followed.y-this.deadZoneY)),this.viewport.x=this.xView,this.viewport.y=this.yView,void 0!==this.worldBounds&&(this.withinWorldBounds()||(this.viewport.x<this.worldBounds.x&&(this.xView=this.worldBounds.x),this.viewport.y<this.worldBounds.y&&(this.yView=this.worldBounds.y),this.viewport.x+this.viewport.width>this.worldBounds.x+this.worldBounds.width&&(this.xView=this.worldBounds.x+this.worldBounds.width-this.viewportWidth),this.viewport.y+this.viewport.height>this.worldBounds.y+this.worldBounds.height&&(this.yView=this.worldBounds.y+this.worldBounds.height-this.viewportHeight))))}withinWorldBounds(){return this.viewport.x<=this.worldBounds.x&&this.viewport.y<=this.worldBounds.y&&this.viewport.x+this.viewport.width>=this.worldBounds.x+this.worldBounds.width&&this.viewport.y+this.viewport.height>=this.worldBounds.y+this.worldBounds.height}}var A=P,E=class{static isState(t){return t instanceof this}constructor(t){let{boot:e=(()=>{}),init:i,update:s,game:r}=t,h=function(t,e){var i={};for(var s in t)e.indexOf(s)>=0||Object.prototype.hasOwnProperty.call(t,s)&&(i[s]=t[s]);return i}(t,["boot","init","update","game"]);this.boot=e,this.isBooted=!1,this._init=i,this._updateCallback=s,this.game=r,this.stage=new class{constructor(){this._children=[],this._sorted}_sortChildren(){this._children=this._children.sort(function(t,e){return t.z-e.z}),this._sorted=!0}bringToFront(t){this._children[this.getChildIndex(t)].z=this._children.length,this._sorted=!1}sendToBack(t){this._children[this.getChildIndex(t)].z=0,this._sorted=!1}setZIndex(t,e){this._children[this.getChildIndex(t)].z=e,this._sorted=!1}getChildIndex(t){return this._children.indexOf(t)}add(t){void 0===t.z?t.z=this._children.length:this._sorted=!1,this._children.push(t)}remove(t){let e=this.getChildIndex(t);e>=0&&this._children.splice(e,1)}update(t){this._children.map(e=>{e.update(t)})}render(t,e){this._sorted||this._sortChildren(),this._children.map(i=>{i.render(i.x,i.y,t,e)})}};for(let t in h)this[t]=h[t];this.game&&(this.camera=new A({xView:0,yView:0,width:this.game.canvas.width,height:this.game.canvas.height}),this._boot().then(()=>{this.isBooted=!0,this._init()}))}bindGameContext(t){this.game=t,this.camera=new A({xView:0,yView:0,width:this.game.canvas.width,height:this.game.canvas.height}),this._boot().then(()=>{this.isBooted=!0,this._init()})}add(t,e){let i,s;switch(e.context||(e.context=this.game.context),t){case"sprite":i=v;break;case"graphic":i=b;break;case"text":i=h;break;default:throw new Error("Game object not supported.")}return s=new i(e),this.stage.add(s),s}_boot(){return this.boot(),this.game.assets.startLoad()}update(t){this.camera.update(),this.stage.update(t),this._updateCallback(t)}render(){this.stage.render(this.camera.xView,this.camera.yView)}};class I{static get IMAGEREGEX(){return/(jpeg|jpg|gif|png)$/}static get AUDIOREGEX(){return/(wav|mp3|ogg|agg)$/}static get NOREGEX(){return/^no$/}static get audioTypes(){const t=new Audio;return{wav:t.canPlayType("audio/wav;").replace(I.NOREGEX,""),mp3:t.canPlayType("audio/mpeg;").replace(I.NOREGEX,""),ogg:t.canPlayType('audio/ogg; codecs="vorbis"').replace(I.NOREGEX,""),aac:t.canPlayType("audio/aac;").replace(I.NOREGEX,"")}}static canUseAudio(t){let e=I.getExtension(t);return!!I.audioTypes[e]}static joinPath(...t){let e=[];for(let i of t)e.push(i.trim().replace(new RegExp("(^[/]{"+(e[0]?1:2)+",}|[/]*$)","g"),""));return e.join("/")}static getExtension(t){return t.split(".").pop()}static getName(t){let e=t.replace(`.${I.getExtension(t)}`,"");return 0==e.indexOf("/")&&0==e.lastIndexOf("/")?e.substr(1):e}constructor({basePath:t="",imagePath:e="",audioPath:i="",dataPath:s=""}){this.images={},this.audio={},this.data={},this.basePath=t,this.imagePath=e,this.audioPath=i,this.dataPath=s,this.loadPromises=[]}loadImage(t,e){let i=""!==t&&void 0!==t?t:I.getName(e),s=new Image,r=I.joinPath(this.imagePath,e);return new Promise((t,e)=>{s.onload=(()=>{this.images[i]=s,t(s)}),s.onerror=(()=>{e(`Unable to load image '${r}'`)}),s.src=r})}loadAudio(t,e){return Array.isArray(e)||(e=[e]),new Promise((i,s)=>{let r;for(let t of e)if(I.canUseAudio(t)){r=t;break}if(r){let e=""!==t&&void 0!==t?t:I.getName(url),h=new Audio,o=I.joinPath(this.audioPath,r);h.addEventListener("canplay",()=>{this.audio[e]=h,i(h)}),h.onerror=(()=>{s(`Unable to load audio ${o}`)}),h.src=o,h.load()}else s("Cannot play any of the audio formats provided.")})}loadData(t,e){let i=""!==t&&void 0!==t?t:I.getName(e),s=new XMLHttpRequest,r=I.joinPath(this.dataPath,e);return new Promise((t,e)=>{s.addEventListener("load",()=>{let r=s.responseText;200!==s.status&&e(r);try{r=JSON.parse(r)}catch(t){e(t)}this.data[i]=r,t(r)}),s.open("GET",r,!0),s.send()})}load(t,e){let i,s=I.getExtension(e);i=s.match(I.IMAGEREGEX)?this.loadImage(t,e):s.match(I.AUDIOREGEX)?this.loadAudio(t,e):this.loadData(t,e),this.loadPromises.push(i)}startLoad(){let t=this.loadPromises;return this.loadPromises=[],Promise.all(t)}}var S=I;const B={Game:class{constructor(t,e,i,s,r="",h,o={}){let a=document.createElement("canvas");if(a.width=t,a.height=e,this.canvas=a,this.context=this.canvas.getContext(s),!i.nodeType&&"string"!=typeof i)throw new Error("A valid id or parentNode is required");if(i.nodeType)i.appendChild(this.canvas);else if("string"==typeof i){let t=document.getElementById(i);if(!t)throw new Error("Parent Element not found.");t.appendChild(this.canvas)}this.name=r,this.state=new class{constructor(t){this.states={},this._current=null,this._gameBinding=t}add(t,e,i){if("string"!=typeof t)throw new Error(`State key needs to be a string. Got ${typeof t} instead.`);if("object"!=typeof e&&!E.isState(e))throw new Error(`State object needs to be an object or instance of BraveEnginge.State. Got ${typeof t} instead.`);if(E.isState(e))e.bindGameContext(this._gameBinding),this.states[t]=e;else{if(!e.init)throw new Error("State requires an init function");if(!e.update)throw new Error("State requires an update function");e.game=this._gameBinding;let i=new E(e);this.states[t]=i}void 0!==i&&i&&(this._current=this.states[t])}remove(t){if(!this.states[t])throw new Error(`State ${t} not found.`);delete this.states[t]}get current(){return this._current}setCurrent(t){if(!this.states[t])throw new Error(`State '${t}' not found.`);this._current=this.states[t]}update(t){this.current.update(t)}render(){this.current.render()}}(this),this.assets=new S(o),this._isPaused=!1,h&&this.state.add("Default",h,!0)}start(){if(!this.state.current)throw new Error("Default State has not been set.");let t,e,i=window.performance.now(),s=0,r=1e3/60,h=()=>{if(e=window.performance.now(),s=e-i,i=e,s>1e3)this.pause();else{for(r+=s;r>=1e3/60;)this.state.current.isBooted&&this.state.current.update(1/60),r-=1e3/60;this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.state.current.isBooted&&this.state.current.render(),this.isPaused?window.cancelAnimationFrame(t):t=window.requestAnimationFrame(h)}};window.requestAnimationFrame(h)}get isPaused(){return this._isPaused}pause(){this._isPaused=!0}resume(){this._isPaused=!1,this.start()}},State:E,Sprite:v,Text:h,Graphic:b};window.BraveEngine=B,e.default=B}]);
</script>
</html>